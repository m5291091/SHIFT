{% extends "admin/base_site.html" %}
{% load i18n %}

{% block content %}
<h1>固定シフトの一括登録</h1>
<p>従業員を選択し、「シフトパターン」を選ぶか、「業務内容」を自由入力してください。その後、カレンダーで対象日を複数選択します。</p>

<form method="post">
    {% csrf_token %}
    {{ form.as_p }}
    <div id="calendar-container"></div>
    <input type="submit" value="保存" class="default" style="margin-top: 1rem;">
</form>
{% endblock %}

{% block extrahead %}
{{ block.super }}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const datesInput = document.getElementById('id_dates');
    flatpickr("#calendar-container", {
        mode: "multiple",
        dateFormat: "Y-m-d",
        inline: true,
        onChange: function(selectedDates) {
            datesInput.value = selectedDates.map(date => {
                const y = date.getFullYear();
                const m = String(date.getMonth() + 1).padStart(2, '0');
                const d = String(date.getDate()).padStart(2, '0');
                return `${y}-${m}-${d}`;
            }).join(',');
        }
    });
});
</script>
{% endblock %}